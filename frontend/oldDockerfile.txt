# Stage 1: Build Vue.js (TypeScript) with npm
FROM node:20-alpine AS builder
WORKDIR /app

#copy package files and install dependencies
COPY package.json package-lock.json ./
RUN npm ci

#copy config files
COPY tsconfig*.json ./
COPY vite.config.ts ./



# copy and build
COPY public ./public
COPY src ./src
RUN npm run build

# Stage 2: serve with caddy
FROM caddy:2-alpine

#copy static assets
COPY --from=builder /app/dist /usr/share/caddy

# Expose HTTP
EXPOSE 80
# Caddyfile provided by docker-compose